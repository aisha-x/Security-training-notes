# LetsDefend: Malware Analysis Fundamentals Summary


# **1- Introduction to Malware Analysis**

 

**As a SOC analyst, you will often analyze suspicious files in your daily work routine. With the Malware fundamentals training, the necessary basic information will be learned by introducing the subject of malware analysis.**

**In this training;**

**Definition of malware,Malware types,Malware analysis approaches,How to analyze suspicious files simply**

- Definition of malware,
- Malware types,
- Malware analysis approaches,
- How to analyze suspicious files simply

# 2- **Malware Definition and Malware Types**

## Malware Overview & Types (Summary)

**Malware definition:**

Malware = *Malicious Software*. It refers to any program designed with harmful intent, such as damaging systems, stealing data, demanding ransom, or ensuring persistence.

- **Used by attackers for:** persistence, damage, espionage, ransom, or unauthorized access.
- **Programming:** Can be written in almost any language. Analysts don’t need all languages, but programming knowledge (especially assembly, C/C++) helps in analysis and reverse engineering.
- **Evasion:** Modern malware often uses obfuscation, packing, or anti-analysis tricks to avoid detection.
- **SOC analyst role:** Analyze suspicious files (from email, AV alerts, or network detections), determine if they’re malicious, classify the type, and report purpose, C2 servers, and attacker goals.

---

## Common Malware Types

- **Backdoor** – Installs a secret entry point for attacker access (e.g., opens a hidden shell or port).
- **Adware** – Displays unwanted ads; sometimes alters browser/search engine settings.
- **Ransomware** – Encrypts/exfiltrates files and demands ransom for recovery (e.g., WannaCry).
- **Virus** – Self-replicating malware that infects other files; often used synonymously with “malware” in casual speech.
- **Worm** – Self-spreading across networks without user interaction (e.g., WannaCry worm via MS17-010).
- **Rootkit** – Hides presence by gaining privileged access, making detection difficult.
- **RAT (Remote Access Trojan)** – Gives attackers full control of the victim’s system.
- **Banking Malware** – Targets financial applications to steal money or credentials.
- **Keylogger** – Records keystrokes and sends them to the attacker.

Malware can **combine multiple features** (e.g., WannaCry was both a worm *and* ransomware).

# What Should a Malware Analyst Know?

Malware analysis requires **multi-disciplinary expertise** — combining OS knowledge, programming, networking, and cryptography. While some SOC analysts only do malware triage, dedicated malware analysts (often Tier 3 or SME roles) go deep into reverse engineering.

---

## Core Knowledge Areas

### 1. **Operating System Fundamentals & Architecture**

- Malware runs on OSes (Windows, Linux, macOS), so analysts need to understand:
    - OS internals (kernel, user space, processes, threads).
    - Memory architecture (stack, heap, virtual memory).
    - OS persistence mechanisms (e.g., Windows Registry, Task Scheduler, Services).
    - APIs and syscalls used by malware to interact with the system.
- Why: Malware often leverages OS features for **privilege escalation, persistence, and stealth**.

---

### 2. **Assembly Language & Programming**

- Processors only understand **machine code (0s & 1s)**.
- Compilers translate high-level code (C, Python, Go, etc.) → Assembly → Machine code.
- Malware binaries are typically analyzed in **Assembly** via disassemblers (e.g., IDA Pro, Ghidra, Radare2).
- Analysts should understand:
    - Registers (EAX, EIP/RIP, ESP/RSP, etc.).
    - Instruction sets (x86, x64).
    - Control flow (jumps, calls, returns).
- Why: Reverse engineering malware depends heavily on reading disassembled code.

---

### 3. **Network Protocols & Fundamentals**

- Malware frequently communicates externally for:
    - C2 (command & control).
    - Data exfiltration.
    - Dropping second-stage payloads.
- Analysts need to understand:
    - TCP/IP model, HTTP/HTTPS, DNS, SMTP, etc.
    - How to analyze network traffic (Wireshark, Zeek).
    - Detecting anomalies or encrypted traffic patterns.
- Why: Network analysis reveals **malware purpose, infrastructure, and attacker intent**.

---

### 4. **Cryptography**

- Used for both defense **and** offense:
    - Defenders: secure communications, file protection.
    - Attackers: obfuscation, encryption, ransomware payloads.
- Analysts must recognize:
    - Common crypto algorithms (AES, RSA, SHA, XOR).
    - How malware uses cryptography for **file encryption, hiding payloads, or protecting C2 traffic**.
- Why: Identifying crypto routines helps detect ransomware and unpack obfuscated malware.

---

# **Which Approach Should You Choose When Analyzing Malware?**

## Malware Analysis Approaches

Malware can be analyzed in **two main ways**:

---

### 1. **Static Analysis** (No Execution)

- **Definition:** Reverse engineering malware **without running it**.
- **Methods:**
    - Disassembling/decompiling (IDA Pro, Ghidra).
    - Inspecting PE headers.
    - Checking imported/exported DLLs.
    - Extracting strings.
    - Studying CPU instructions.
- **Advantages:**
    - Safe (malware isn’t executed).
    - Reveals detailed code logic.
- **Disadvantages:**
    - Requires reverse engineering skills.
    - May be difficult if malware is packed/obfuscated.
- **Best for:** Deep dive into malware capabilities, persistence techniques, hidden functionality.

---

### 2. **Dynamic Analysis** (Execution in Controlled Environment)

- **Definition:** Running malware in a **sandbox or VM** to observe behavior.
- **Methods:** Monitor:
    - Network connections (C2, downloads).
    - File system changes (new files, deletions).
    - Process events (new processes, injection).
    - Registry changes (persistence, configs).
- **Advantages:**
    - Quick results (see what malware *actually does*).
    - Easier for less experienced analysts.
- **Disadvantages:**
    - Riskier (must isolate with VM/sandbox).
    - Malware may detect sandbox/VM and hide behavior.
- **Best for:** Rapid triage, spotting C2 servers, confirming suspected activity.

---

### 3. **Static vs Dynamic — Which to Choose?**

- Neither is strictly “better” — they **complement each other**.
- **Dynamic analysis** → good for quick answers (e.g., get C2 IP/domain fast).
- **Static analysis** → good for uncovering hidden functionality and full behavior.
- **Combined use** = strongest approach (deep + fast).

### Takeaway for SOC Analysts

- **Level 1–2 SOC analysts:** Focus on **dynamic analysis** for quick actionable intelligence (e.g., find C2).
- **Level 3 / Malware analysts:** Perform **both static and dynamic analysis** for full reverse engineering

# **29 Addresses to Analyze Malware Faster**

**We constantly spend time analyzing malware. We have listed 29 addresses that can be useful for blue team members to use time more effectively:
• [Anlyz](https://sandbox.anlyz.io/)
• [Any.run](https://app.any.run/)
• [Comodo Valkyrie](https://valkyrie.comodo.com/)
• [Cuckoo](https://sandbox.pikker.ee/)
• [Hybrid Analysis](http://www.hybrid-analysis.com/)
• [Intezer Analyze](https://www.intezer.com/)
• [SecondWrite Malware Deepview](https://www.secondwrite.com/)
• [Jevereg](http://jevereg.amnpardaz.com/)
• [IObit Cloud](http://cloud.iobit.com/)
• [BinaryGuard](http://www.binaryguard.com/)
• [BitBlaze](http://bitblaze.cs.berkeley.edu/)
• [SandDroid](http://sanddroid.xjtu.edu.cn/)
• [Joe Sandbox](https://www.joesandbox.com/#windows)
• [AMAaaS](https://amaaas.com/)
• [IRIS-H](https://iris-h.services/pages/dashboard#/pages/dashboard)
• [Gatewatcher Intelligence](https://intelligence.gatewatcher.com/)
• [Hatching Triage](https://tria.ge/) 
• [InQuest Labs](https://labs.inquest.net/dfi)
• [Manalyzer](https://manalyzer.org/)
• [SandBlast Analysis](https://threatpoint.checkpoint.com/ThreatPortal/emulation)
• [SNDBOX](https://app.sndbox.com/)
• [firmware](http://firmware.re/)
• [opswat](https://metadefender.opswat.com/?lang=en)
• [virusade](http://virusade.com/)
• [virustotal](https://www.virustotal.com/gui/)
• [malware config](https://malwareconfig.com/)
• [malware hunter team](https://id-ransomware.malwarehunterteam.com/)
• [virscan](http://www.virscan.org/) 
• [jotti](https://virusscan.jotti.org/it)**
